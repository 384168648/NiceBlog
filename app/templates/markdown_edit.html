{% extends "common_base.html" %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='github_markdown.css') }}" type="text/css"/>
    <script src="{{ url_for('static', filename='marked.js') }}"></script>
    <script src="{{ url_for('static', filename='ace-min/ace.js') }}"></script>
{% endblock %}

{% block page_title %}{% if type == 'create' %}写文章{% elif type == 'edit' %}编辑文章{% endif %}{% endblock %}

{% block content %}
    <div class="container-fluid height-full">
        <div class="row height-full">
            <div class="col-md-6 markdown-panel">
                <div id="markdown-edit">{% if form.content.data %}{{ form.content.data }}{% endif %}</div>
            </div>

            <div class="col-md-6 markdown-panel">
                <div id="markdown-preview" class="markdown-body"></div>
            </div>

        </div>

    </div>
{% endblock %}

{% block scripts %}
    {{ super() }}

    <script>
        $('body').addClass('markdown-blog-body');
        $('html').addClass('height-full');


        var ace_edit = ace.edit('markdown-edit');

        if (ace_edit.getValue()) {
            $("#markdown-preview").html(marked(ace_edit.getValue()));
        }

        ace_edit.setTheme('ace/theme/chrome');
        ace_edit.getSession().setMode('ace/mode/markdown');
        ace_edit.renderer.setShowPrintMargin(false);
        //字体大小
        ace_edit.setFontSize(15);
        //自动换行
        ace_edit.setOption('wrap', 'free');
        $("#markdown-edit").keyup(function () {
            $("#markdown-preview").html(marked(ace_edit.getValue()));
        });

    </script>
{% endblock %}


